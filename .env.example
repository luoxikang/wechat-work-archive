# 企业微信群聊天记录存档系统环境配置示例
# 复制此文件为 .env 并填入实际配置值

# ================================================================================
# 企业微信配置 (必填)
# ================================================================================
# 企业微信企业ID
CORP_ID=your_corp_id_here

# 企业微信应用Secret
SECRET=your_secret_here

# 消息加密密钥
ENCODING_AES_KEY=your_encoding_aes_key_here

# 企业微信API基础URL (通常不需要修改)
WECHAT_API_BASE_URL=https://qyapi.weixin.qq.com

# Token缓存时间 (秒)
TOKEN_CACHE_TTL=7000

# API请求重试次数
MAX_RETRY_ATTEMPTS=3

# API请求超时时间 (秒)
REQUEST_TIMEOUT=30

# ================================================================================
# 数据库配置 (必填)
# ================================================================================
# 数据库连接URL
DATABASE_URL=postgresql://wechat_admin:your_db_password@postgres:5432/wechat_archive

# 数据库名称
DB_NAME=wechat_archive

# 数据库用户名
DB_USER=wechat_admin

# 数据库密码 (请使用强密码)
DB_PASSWORD=your_secure_db_password_here

# 数据库连接池配置
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600
DB_ECHO=false

# ================================================================================
# Redis配置
# ================================================================================
# Redis连接URL
REDIS_URL=redis://:your_redis_password@redis:6379/0

# Redis密码 (可选)
REDIS_PASSWORD=your_redis_password_here

# Redis最大连接数
REDIS_MAX_CONNECTIONS=20

# Redis连接超时 (秒)
REDIS_TIMEOUT=5

# ================================================================================
# Celery任务队列配置
# ================================================================================
# Celery Broker URL
CELERY_BROKER_URL=redis://:your_redis_password@redis:6379/1

# Celery结果后端URL
CELERY_RESULT_BACKEND=redis://:your_redis_password@redis:6379/2

# Celery时区
CELERY_TIMEZONE=Asia/Shanghai

# Celery序列化格式
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json

# Celery Worker数量
CELERY_WORKERS=4

# ================================================================================
# API服务配置
# ================================================================================
# API服务主机
API_HOST=0.0.0.0

# API服务端口
API_PORT=8000

# API Worker进程数
API_WORKERS=4

# 允许的跨域源 (逗号分隔)
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000

# ================================================================================
# 同步配置
# ================================================================================
# 消息同步间隔 (秒)
SYNC_INTERVAL=300

# 最大同步天数
MAX_SYNC_DAYS=90

# 批处理大小
BATCH_SIZE=100

# 是否启用自动同步
ENABLE_AUTO_SYNC=true

# ================================================================================
# 媒体文件配置
# ================================================================================
# 是否启用媒体文件下载
ENABLE_MEDIA_DOWNLOAD=true

# 媒体文件存储路径
MEDIA_STORAGE_PATH=/app/media

# 最大文件大小 (字节，默认100MB)
MAX_FILE_SIZE=104857600

# 允许的文件类型 (逗号分隔)
ALLOWED_FILE_TYPES=jpg,jpeg,png,gif,mp4,avi,mp3,wav,doc,docx,pdf,txt

# 媒体文件URL前缀
MEDIA_URL_PREFIX=/media

# ================================================================================
# 安全配置
# ================================================================================
# JWT密钥 (请使用强随机字符串)
SECRET_KEY=your_super_secret_jwt_key_here_change_this_in_production

# Access Token过期时间 (分钟)
ACCESS_TOKEN_EXPIRE_MINUTES=30

# JWT算法
ALGORITHM=HS256

# 是否启用安全认证
ENABLE_SECURITY=true

# ================================================================================
# 日志和监控配置
# ================================================================================
# 日志级别 (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# 是否启用详细日志
DEBUG=false

# 日志文件路径
LOG_FILE_PATH=/app/logs/app.log

# 日志轮转周期
LOG_ROTATION=1 week

# 日志保留时间
LOG_RETENTION=1 month

# 是否启用指标收集
ENABLE_METRICS=true

# Sentry DSN (可选，用于错误监控)
SENTRY_DSN=

# ================================================================================
# 监控配置
# ================================================================================
# Grafana管理员密码
GRAFANA_PASSWORD=your_grafana_admin_password

# Grafana用户名
GRAFANA_USER=admin

# ================================================================================
# 性能配置
# ================================================================================
# 是否启用缓存
ENABLE_CACHE=true

# 缓存TTL (秒)
CACHE_TTL=300

# 是否启用压缩
ENABLE_COMPRESSION=true

# 最大请求大小 (字节，默认16MB)
MAX_REQUEST_SIZE=16777216

# Worker副本数
WORKER_REPLICAS=2

# ================================================================================
# 开发和测试配置
# ================================================================================
# 是否为测试环境
TESTING=false

# 是否启用热重载 (仅开发环境)
RELOAD=false

# 测试数据库URL (可选)
TEST_DATABASE_URL=

# ================================================================================
# Docker和部署配置
# ================================================================================
# 容器镜像仓库
REGISTRY=ghcr.io

# 镜像名称
IMAGE_NAME=your-org/wechat-work-archive

# 部署版本
VERSION=latest

# 域名 (生产环境)
DOMAIN=your-domain.com

# ================================================================================
# 备份配置
# ================================================================================
# 备份保留天数
BACKUP_RETENTION_DAYS=30

# 是否启用自动备份
ENABLE_AUTO_BACKUP=true

# 备份存储路径
BACKUP_STORAGE_PATH=/opt/backups

# ================================================================================
# 外部集成配置 (可选)
# ================================================================================
# 邮件配置 (用于通知)
MAIL_SERVER=
MAIL_PORT=587
MAIL_USERNAME=
MAIL_PASSWORD=
MAIL_USE_TLS=true

# Slack Webhook (用于通知)
SLACK_WEBHOOK_URL=

# 钉钉Webhook (用于通知)
DINGTALK_WEBHOOK_URL=

# ================================================================================
# 高级配置 (通常不需要修改)
# ================================================================================
# 数据库连接字符串模板
DATABASE_URL_TEMPLATE=postgresql://${DB_USER}:${DB_PASSWORD}@postgres:5432/${DB_NAME}

# Redis连接字符串模板
REDIS_URL_TEMPLATE=redis://:${REDIS_PASSWORD}@redis:6379/0

# API基础URL
API_BASE_URL=http://api:8000

# 健康检查URL
HEALTH_CHECK_URL=http://api:8000/health

# Prometheus指标URL
METRICS_URL=http://api:8000/metrics

# ================================================================================
# 环境特定配置
# ================================================================================
# 当前环境 (development, staging, production)
ENVIRONMENT=production

# 是否为生产环境
PRODUCTION=true

# 构建时间戳
BUILD_TIMESTAMP=

# Git提交哈希
GIT_COMMIT=

# 构建版本
BUILD_VERSION=